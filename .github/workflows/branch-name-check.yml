name: Branch Name Check

on:
  pull_request:
    types: [opened, synchronize, reopened]

jobs:
  check-branch-name:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Check Branch Name
        run: |
          branch_name="${{ github.head_ref }}"

          if [[ "$branch_name" =~ ^release/ ]]; then
            if ! [[ "$branch_name" =~ ^release/[0-3][0-9]\.[0-1][0-9]\.[0-9]{2}-v[0-9]+\.[0-9]+\.[0-9]+$ ]]; then
              echo "Release branch name must match pattern: release/dd.mm.yy-vx.y.z"
              exit 1
            fi
          else
            if ! [[ "$branch_name" =~ ^(feat/DLR-[0-9]+|fix/DLR-[0-9]+|hotfix/.*)$ ]]; then
              echo "Branch name must start with 'feat/DLR-', 'fix/DLR-', or 'hotfix/'"
              exit 1
            fi
          fi
